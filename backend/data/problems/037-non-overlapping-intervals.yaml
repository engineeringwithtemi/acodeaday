title: Non-overlapping Intervals
sequence_number: 37
difficulty: medium
pattern:
  - intervals
  - greedy
  - sorting

description: |
  Given an array of intervals `intervals` where `intervals[i] = [starti, endi]`, return the minimum number of intervals you need to remove to make the rest of the intervals non-overlapping.

constraints:
  - "1 <= intervals.length <= 10^5"
  - "intervals[i].length == 2"
  - "-5 * 10^4 <= starti < endi <= 5 * 10^4"

examples:
  - input: "intervals = [[1,2],[2,3],[3,4],[1,3]]"
    output: "1"
    explanation: "[1,3] can be removed and the rest of the intervals are non-overlapping."
  - input: "intervals = [[1,2],[1,2],[1,2]]"
    output: "2"
    explanation: "You need to remove two [1,2] to make the rest of the intervals non-overlapping."
  - input: "intervals = [[1,2],[2,3]]"
    output: "0"
    explanation: "You don't need to remove any of the intervals since they're already non-overlapping."

languages:
  python:
    starter_code: |
      class Solution:
          def eraseOverlapIntervals(self, intervals: List[List[int]]) -> int:
              pass
    reference_solution: |
      class Solution:
          def eraseOverlapIntervals(self, intervals: List[List[int]]) -> int:
              if not intervals:
                  return 0

              # Sort by end time (greedy: keep intervals that end earliest)
              intervals.sort(key=lambda x: x[1])

              count = 0
              prev_end = float('-inf')

              for start, end in intervals:
                  if start >= prev_end:
                      # No overlap, keep this interval
                      prev_end = end
                  else:
                      # Overlap, remove current interval
                      count += 1

              return count
    function_signature:
      name: eraseOverlapIntervals
      params:
        - name: intervals
          type: "List[List[int]]"
      return_type: int

test_cases:
  - input: [[[1, 2], [2, 3], [3, 4], [1, 3]]]
    expected: 1
  - input: [[[1, 2], [1, 2], [1, 2]]]
    expected: 2
  - input: [[[1, 2], [2, 3]]]
    expected: 0
  - input: [[[1, 100], [11, 22], [1, 11], [2, 12]]]
    expected: 2
  - input: [[[0, 2], [1, 3], [2, 4], [3, 5], [4, 6]]]
    expected: 2
  - input: [[[1, 2]]]
    expected: 0
  - input: [[[-52, 31], [-73, -26], [82, 97], [-65, -11], [-62, -49], [95, 99], [58, 95], [-31, 49], [66, 98], [-63, 2], [30, 47], [-40, -26]]]
    expected: 7
  - input: [[[1, 2], [2, 3], [3, 4], [4, 5]]]
    expected: 0
  - input: [[[1, 5], [2, 3], [3, 4], [4, 5]]]
    expected: 1
  - input: [[[0, 1], [3, 4], [1, 2]]]
    expected: 0
  - input: [[[-1, 0], [0, 1], [1, 2]]]
    expected: 0
  - input: [[[-1, 1], [0, 1], [1, 2]]]
    expected: 1
  - input: [[[1, 10], [2, 3], [4, 5], [6, 7]]]
    expected: 1
  - input: [[[1, 2], [1, 3], [1, 4]]]
    expected: 2
  - input: [[[1, 2], [2, 3], [2, 3], [3, 4]]]
    expected: 1
  - input: [[[1, 2], [2, 3], [3, 4], [1, 3], [2, 4]]]
    expected: 2
  - input: [[[0, 2], [1, 3], [1, 3], [2, 4], [3, 5], [3, 5], [4, 6]]]
    expected: 4
  - input: [[[-100, -50], [-49, 0], [1, 50], [51, 100]]]
    expected: 0
  - input: [[[0, 10], [5, 15], [10, 20], [15, 25]]]
    expected: 2
  - input: [[[0, 5], [1, 2], [2, 3], [3, 4], [4, 5]]]
    expected: 1
