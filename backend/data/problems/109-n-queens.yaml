title: N-Queens
sequence_number: 109
difficulty: hard
pattern:
  - backtracking

description: |
  The **n-queens** puzzle is the problem of placing `n` queens on an `n x n` chessboard such that no two queens attack each other.

  Given an integer `n`, return all distinct solutions to the **n-queens puzzle**. You may return the answer in **any order**.

  Each solution contains a distinct board configuration of the n-queens' placement, where `'Q'` and `'.'` both indicate a queen and an empty space, respectively.

constraints:
  - "1 <= n <= 9"

examples:
  - input: "n = 4"
    output: '[["..Q.",".Q..","Q...","...Q"],[".Q...","...Q","Q...","..Q."]]'
  - input: "n = 1"
    output: '[["Q"]]'

languages:
  python:
    starter_code: |
      class Solution:
          def solveNQueens(self, n: int) -> List[List[str]]:
              pass
    reference_solution: |
      class Solution:
          def solveNQueens(self, n: int) -> List[List[str]]:
              result = []
              board = [['.'] * n for _ in range(n)]
              cols = set()
              diag1 = set()  # row - col
              diag2 = set()  # row + col

              def backtrack(row):
                  if row == n:
                      result.append([''.join(r) for r in board])
                      return

                  for col in range(n):
                      if col in cols or (row - col) in diag1 or (row + col) in diag2:
                          continue

                      board[row][col] = 'Q'
                      cols.add(col)
                      diag1.add(row - col)
                      diag2.add(row + col)

                      backtrack(row + 1)

                      board[row][col] = '.'
                      cols.remove(col)
                      diag1.remove(row - col)
                      diag2.remove(row + col)

              backtrack(0)
              return result
    function_signature:
      name: solveNQueens
      params:
        - name: n
          type: int
      return_type: "List[List[str]]"

test_cases:
  - input: [4]
    expected: [[".Q..", "...Q", "Q...", "..Q."], ["..Q.", "Q...", "...Q", ".Q.."]]
  - input: [1]
    expected: [["Q"]]
  - input: [2]
    expected: []
  - input: [3]
    expected: []
  - input: [5]
    expected: [["Q....", "..Q..", "....Q", ".Q...", "...Q."], ["Q....", "...Q.", ".Q...", "....Q", "..Q.."], [".Q...", "...Q.", "Q....", "..Q..", "....Q"], [".Q...", "....Q", "..Q..", "Q....", "...Q."], ["..Q..", "Q....", "...Q.", ".Q...", "....Q"], ["..Q..", "....Q", ".Q...", "...Q.", "Q...."], ["...Q.", "Q....", "..Q..", "....Q", ".Q..."], ["...Q.", ".Q...", "....Q", "..Q..", "Q...."], ["....Q", ".Q...", "...Q.", "Q....", "..Q.."], ["....Q", "..Q..", "Q....", "...Q.", ".Q..."]]
  - input: [6]
    expected: [[".Q....", "...Q..", ".....Q", "Q.....", "..Q...", "....Q."], ["..Q...", ".....Q", ".Q....", "....Q.", "Q.....", "...Q.."], ["...Q..", "Q.....", "....Q.", ".Q....", ".....Q", "..Q..."], ["....Q.", "..Q...", "Q.....", ".....Q", "...Q..", ".Q...."]]
  - input: [7]
    expected: [["Q......", "..Q....", "....Q..", "......Q", ".Q.....", "...Q...", ".....Q."], ["Q......", "...Q...", "......Q", "..Q....", ".....Q.", ".Q.....", "....Q.."], ["Q......", "....Q..", ".Q.....", ".....Q.", "..Q....", "......Q", "...Q..."], ["Q......", ".....Q.", "...Q...", ".Q.....", "......Q", "....Q..", "..Q...."], [".Q.....", "...Q...", "Q......", "......Q", "....Q..", "..Q....", ".....Q."], [".Q.....", "...Q...", ".....Q.", "Q......", "..Q....", "....Q..", "......Q"], [".Q.....", "....Q..", "Q......", "...Q...", "......Q", "..Q....", ".....Q."], [".Q.....", "....Q..", "..Q....", "Q......", "......Q", "...Q...", ".....Q."], [".Q.....", "....Q..", "......Q", "...Q...", "Q......", "..Q....", ".....Q."], [".Q.....", ".....Q.", "..Q....", "......Q", "...Q...", "Q......", "....Q.."], [".Q.....", "......Q", "....Q..", "..Q....", "Q......", ".....Q.", "...Q..."], ["..Q....", "Q......", ".....Q.", ".Q.....", "....Q..", "......Q", "...Q..."], ["..Q....", "Q......", ".....Q.", "...Q...", ".Q.....", "......Q", "....Q.."], ["..Q....", "....Q..", "......Q", ".Q.....", "...Q...", ".....Q.", "Q......"], ["..Q....", ".....Q.", ".Q.....", "....Q..", "Q......", "...Q...", "......Q"], ["..Q....", "......Q", ".Q.....", "...Q...", ".....Q.", "Q......", "....Q.."], ["..Q....", "......Q", "...Q...", "Q......", "....Q..", ".Q.....", ".....Q."], ["...Q...", "Q......", "..Q....", ".....Q.", ".Q.....", "......Q", "....Q.."], ["...Q...", "Q......", "....Q..", ".Q.....", ".....Q.", "..Q....", "......Q"], ["...Q...", ".Q.....", "......Q", "....Q..", "..Q....", "Q......", ".....Q."], ["...Q...", ".....Q.", "Q......", "..Q....", "....Q..", "......Q", ".Q....."], ["...Q...", "......Q", "..Q....", ".....Q.", ".Q.....", "....Q..", "Q......"], ["...Q...", "......Q", "....Q..", ".Q.....", ".....Q.", "Q......", "..Q...."], ["....Q..", "Q......", "...Q...", "......Q", "..Q....", ".....Q.", ".Q....."], ["....Q..", "Q......", ".....Q.", "...Q...", ".Q.....", "......Q", "..Q...."], ["....Q..", ".Q.....", ".....Q.", "..Q....", "......Q", "...Q...", "Q......"], ["....Q..", "..Q....", "Q......", ".....Q.", "...Q...", ".Q.....", "......Q"], ["....Q..", "......Q", ".Q.....", "...Q...", ".....Q.", "Q......", "..Q...."], ["....Q..", "......Q", ".Q.....", ".....Q.", "..Q....", "Q......", "...Q..."], [".....Q.", "Q......", "..Q....", "....Q..", "......Q", ".Q.....", "...Q..."], [".....Q.", ".Q.....", "....Q..", "Q......", "...Q...", "......Q", "..Q...."], [".....Q.", "..Q....", "Q......", "...Q...", "......Q", "....Q..", ".Q....."], [".....Q.", "..Q....", "....Q..", "......Q", "Q......", "...Q...", ".Q....."], [".....Q.", "..Q....", "......Q", "...Q...", "Q......", "....Q..", ".Q....."], [".....Q.", "...Q...", ".Q.....", "......Q", "....Q..", "..Q....", "Q......"], [".....Q.", "...Q...", "......Q", "Q......", "..Q....", "....Q..", ".Q....."], ["......Q", ".Q.....", "...Q...", ".....Q.", "Q......", "..Q....", "....Q.."], ["......Q", "..Q....", ".....Q.", ".Q.....", "....Q..", "Q......", "...Q..."], ["......Q", "...Q...", "Q......", "....Q..", ".Q.....", ".....Q.", "..Q...."], ["......Q", "....Q..", "..Q....", "Q......", ".....Q.", "...Q...", ".Q....."]]
  - input: [8]
    expected: [["Q.......", "....Q...", ".......Q", ".....Q..", "..Q.....", "......Q.", ".Q......", "...Q...."], ["Q.......", ".....Q..", ".......Q", "..Q.....", "......Q.", "...Q....", ".Q......", "....Q..."], ["Q.......", "......Q.", "...Q....", ".....Q..", ".......Q", ".Q......", "....Q...", "..Q....."], ["Q.......", "......Q.", "....Q...", ".......Q", ".Q......", "...Q....", ".....Q..", "..Q....."], [".Q......", "...Q....", ".....Q..", ".......Q", "..Q.....", "Q.......", "......Q.", "....Q..."], [".Q......", "....Q...", "......Q.", "Q.......", "..Q.....", ".......Q", ".....Q..", "...Q...."], [".Q......", "....Q...", "......Q.", "...Q....", "Q.......", ".......Q", ".....Q..", "..Q....."], [".Q......", ".....Q..", "Q.......", "......Q.", "...Q....", ".......Q", "..Q.....", "....Q..."], [".Q......", ".....Q..", ".......Q", "..Q.....", "Q.......", "...Q....", "......Q.", "....Q..."], [".Q......", "......Q.", "..Q.....", ".....Q..", ".......Q", "....Q...", "Q.......", "...Q...."], [".Q......", "......Q.", "....Q...", ".......Q", "Q.......", "...Q....", ".....Q..", "..Q....."], [".Q......", ".......Q", ".....Q..", "Q.......", "..Q.....", "....Q...", "......Q.", "...Q...."], ["..Q.....", "Q.......", "......Q.", "....Q...", ".......Q", ".Q......", "...Q....", ".....Q.."], ["..Q.....", "....Q...", ".Q......", ".......Q", "Q.......", "......Q.", "...Q....", ".....Q.."], ["..Q.....", "....Q...", ".Q......", ".......Q", ".....Q..", "...Q....", "......Q.", "Q......."], ["..Q.....", "....Q...", "......Q.", "Q.......", "...Q....", ".Q......", ".......Q", ".....Q.."], ["..Q.....", "....Q...", ".......Q", "...Q....", "Q.......", "......Q.", ".Q......", ".....Q.."], ["..Q.....", ".....Q..", ".Q......", "....Q...", ".......Q", "Q.......", "......Q.", "...Q...."], ["..Q.....", ".....Q..", ".Q......", "......Q.", "Q.......", "...Q....", ".......Q", "....Q..."], ["..Q.....", ".....Q..", ".Q......", "......Q.", "....Q...", "Q.......", ".......Q", "...Q...."], ["..Q.....", ".....Q..", "...Q....", "Q.......", ".......Q", "....Q...", "......Q.", ".Q......"], ["..Q.....", ".....Q..", "...Q....", ".Q......", ".......Q", "....Q...", "......Q.", "Q......."], ["..Q.....", ".....Q..", ".......Q", "Q.......", "...Q....", "......Q.", "....Q...", ".Q......"], ["..Q.....", ".....Q..", ".......Q", "Q.......", "....Q...", "......Q.", ".Q......", "...Q...."], ["..Q.....", ".....Q..", ".......Q", ".Q......", "...Q....", "Q.......", "......Q.", "....Q..."], ["..Q.....", "......Q.", ".Q......", ".......Q", "....Q...", "Q.......", "...Q....", ".....Q.."], ["..Q.....", "......Q.", ".Q......", ".......Q", ".....Q..", "...Q....", "Q.......", "....Q..."], ["..Q.....", ".......Q", "...Q....", "......Q.", "Q.......", ".....Q..", ".Q......", "....Q..."], ["...Q....", "Q.......", "....Q...", ".......Q", ".Q......", "......Q.", "..Q.....", ".....Q.."], ["...Q....", "Q.......", "....Q...", ".......Q", ".....Q..", "..Q.....", "......Q.", ".Q......"], ["...Q....", ".Q......", "....Q...", ".......Q", ".....Q..", "Q.......", "..Q.....", "......Q."], ["...Q....", ".Q......", "......Q.", "..Q.....", ".....Q..", ".......Q", "Q.......", "....Q..."], ["...Q....", ".Q......", "......Q.", "..Q.....", ".....Q..", ".......Q", "....Q...", "Q......."], ["...Q....", ".Q......", "......Q.", "....Q...", "Q.......", ".......Q", ".....Q..", "..Q....."], ["...Q....", ".Q......", ".......Q", "....Q...", "......Q.", "Q.......", "..Q.....", ".....Q.."], ["...Q....", ".Q......", ".......Q", ".....Q..", "Q.......", "..Q.....", "....Q...", "......Q."], ["...Q....", ".....Q..", "Q.......", "....Q...", ".Q......", ".......Q", "..Q.....", "......Q."], ["...Q....", ".....Q..", ".......Q", ".Q......", "......Q.", "Q.......", "..Q.....", "....Q..."], ["...Q....", ".....Q..", ".......Q", "..Q.....", "Q.......", "......Q.", "....Q...", ".Q......"], ["...Q....", "......Q.", "Q.......", ".......Q", "....Q...", ".Q......", ".....Q..", "..Q....."], ["...Q....", "......Q.", "..Q.....", ".......Q", ".Q......", "....Q...", "Q.......", ".....Q.."], ["...Q....", "......Q.", "....Q...", ".Q......", ".....Q..", "Q.......", "..Q.....", ".......Q"], ["...Q....", "......Q.", "....Q...", "..Q.....", "Q.......", ".....Q..", ".......Q", ".Q......"], ["...Q....", ".......Q", "Q.......", "..Q.....", ".....Q..", ".Q......", "......Q.", "....Q..."], ["...Q....", ".......Q", "Q.......", "....Q...", "......Q.", ".Q......", ".....Q..", "..Q....."], ["...Q....", ".......Q", "....Q...", "..Q.....", "Q.......", "......Q.", ".Q......", ".....Q.."], ["....Q...", "Q.......", "...Q....", ".....Q..", ".......Q", ".Q......", "......Q.", "..Q....."], ["....Q...", "Q.......", ".......Q", "...Q....", ".Q......", "......Q.", "..Q.....", ".....Q.."], ["....Q...", "Q.......", ".......Q", ".....Q..", "..Q.....", "......Q.", ".Q......", "...Q...."], ["....Q...", ".Q......", "...Q....", ".....Q..", ".......Q", "..Q.....", "Q.......", "......Q."], ["....Q...", ".Q......", "...Q....", "......Q.", "..Q.....", ".......Q", ".....Q..", "Q......."], ["....Q...", ".Q......", ".....Q..", "Q.......", "......Q.", "...Q....", ".......Q", "..Q....."], ["....Q...", ".Q......", ".......Q", "Q.......", "...Q....", "......Q.", "..Q.....", ".....Q.."], ["....Q...", "..Q.....", "Q.......", ".....Q..", ".......Q", ".Q......", "...Q....", "......Q."], ["....Q...", "..Q.....", "Q.......", "......Q.", ".Q......", ".......Q", ".....Q..", "...Q...."], ["....Q...", "..Q.....", ".......Q", "...Q....", "......Q.", "Q.......", ".....Q..", ".Q......"], ["....Q...", "......Q.", "Q.......", "..Q.....", ".......Q", ".....Q..", "...Q....", ".Q......"], ["....Q...", "......Q.", "Q.......", "...Q....", ".Q......", ".......Q", ".....Q..", "..Q....."], ["....Q...", "......Q.", ".Q......", "...Q....", ".......Q", "Q.......", "..Q.....", ".....Q.."], ["....Q...", "......Q.", ".Q......", ".....Q..", "..Q.....", "Q.......", "...Q....", ".......Q"], ["....Q...", "......Q.", ".Q......", ".....Q..", "..Q.....", "Q.......", ".......Q", "...Q...."], ["....Q...", "......Q.", "...Q....", "Q.......", "..Q.....", ".......Q", ".....Q..", ".Q......"], ["....Q...", ".......Q", "...Q....", "Q.......", "..Q.....", ".....Q..", ".Q......", "......Q."], ["....Q...", ".......Q", "...Q....", "Q.......", "......Q.", ".Q......", ".....Q..", "..Q....."], [".....Q..", "Q.......", "....Q...", ".Q......", ".......Q", "..Q.....", "......Q.", "...Q...."], [".....Q..", ".Q......", "......Q.", "Q.......", "..Q.....", "....Q...", ".......Q", "...Q...."], [".....Q..", ".Q......", "......Q.", "Q.......", "...Q....", ".......Q", "....Q...", "..Q....."], [".....Q..", "..Q.....", "Q.......", "......Q.", "....Q...", ".......Q", ".Q......", "...Q...."], [".....Q..", "..Q.....", "Q.......", ".......Q", "...Q....", ".Q......", "......Q.", "....Q..."], [".....Q..", "..Q.....", "Q.......", ".......Q", "....Q...", ".Q......", "...Q....", "......Q."], [".....Q..", "..Q.....", "....Q...", "......Q.", "Q.......", "...Q....", ".Q......", ".......Q"], [".....Q..", "..Q.....", "....Q...", ".......Q", "Q.......", "...Q....", ".Q......", "......Q."], [".....Q..", "..Q.....", "......Q.", ".Q......", "...Q....", ".......Q", "Q.......", "....Q..."], [".....Q..", "..Q.....", "......Q.", ".Q......", ".......Q", "....Q...", "Q.......", "...Q...."], [".....Q..", "..Q.....", "......Q.", "...Q....", "Q.......", ".......Q", ".Q......", "....Q..."], [".....Q..", "...Q....", "Q.......", "....Q...", ".......Q", ".Q......", "......Q.", "..Q....."], [".....Q..", "...Q....", ".Q......", ".......Q", "....Q...", "......Q.", "Q.......", "..Q....."], [".....Q..", "...Q....", "......Q.", "Q.......", "..Q.....", "....Q...", ".Q......", ".......Q"], [".....Q..", "...Q....", "......Q.", "Q.......", ".......Q", ".Q......", "....Q...", "..Q....."], [".....Q..", ".......Q", ".Q......", "...Q....", "Q.......", "......Q.", "....Q...", "..Q....."], ["......Q.", "Q.......", "..Q.....", ".......Q", ".....Q..", "...Q....", ".Q......", "....Q..."], ["......Q.", ".Q......", "...Q....", "Q.......", ".......Q", "....Q...", "..Q.....", ".....Q.."], ["......Q.", ".Q......", ".....Q..", "..Q.....", "Q.......", "...Q....", ".......Q", "....Q..."], ["......Q.", "..Q.....", "Q.......", ".....Q..", ".......Q", "....Q...", ".Q......", "...Q...."], ["......Q.", "..Q.....", ".......Q", ".Q......", "....Q...", "Q.......", ".....Q..", "...Q...."], ["......Q.", "...Q....", ".Q......", "....Q...", ".......Q", "Q.......", "..Q.....", ".....Q.."], ["......Q.", "...Q....", ".Q......", ".......Q", ".....Q..", "Q.......", "..Q.....", "....Q..."], ["......Q.", "....Q...", "..Q.....", "Q.......", ".....Q..", ".......Q", ".Q......", "...Q...."], [".......Q", ".Q......", "...Q....", "Q.......", "......Q.", "....Q...", "..Q.....", ".....Q.."], [".......Q", ".Q......", "....Q...", "..Q.....", "Q.......", "......Q.", "...Q....", ".....Q.."], [".......Q", "..Q.....", "Q.......", ".....Q..", ".Q......", "....Q...", "......Q.", "...Q...."], [".......Q", "...Q....", "Q.......", "..Q.....", ".....Q..", ".Q......", "......Q.", "....Q..."]]
