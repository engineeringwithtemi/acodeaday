title: Course Schedule
sequence_number: 28
difficulty: medium
pattern:
  - graph
  - topological-sort
  - dfs
  - cycle-detection

description: |
  There are a total of `numCourses` courses you have to take, labeled from `0` to `numCourses - 1`. You are given an array `prerequisites` where `prerequisites[i] = [ai, bi]` indicates that you **must** take course `bi` first if you want to take course `ai`.

  For example, the pair `[0, 1]`, indicates that to take course `0` you have to first take course `1`.

  Return `true` if you can finish all courses. Otherwise, return `false`.

constraints:
  - "1 <= numCourses <= 2000"
  - "0 <= prerequisites.length <= 5000"
  - "prerequisites[i].length == 2"
  - "0 <= ai, bi < numCourses"
  - "All the pairs prerequisites[i] are unique."

examples:
  - input: "numCourses = 2, prerequisites = [[1,0]]"
    output: "true"
    explanation: "There are a total of 2 courses to take. To take course 1 you should have finished course 0. So it is possible."
  - input: "numCourses = 2, prerequisites = [[1,0],[0,1]]"
    output: "false"
    explanation: "There are a total of 2 courses to take. To take course 1 you should have finished course 0, and to take course 0 you should also have finished course 1. So it is impossible."

languages:
  python:
    starter_code: |
      class Solution:
          def canFinish(self, numCourses: int, prerequisites: List[List[int]]) -> bool:
              pass
    reference_solution: |
      class Solution:
          def canFinish(self, numCourses: int, prerequisites: List[List[int]]) -> bool:
              # Build adjacency list
              graph = [[] for _ in range(numCourses)]
              for course, prereq in prerequisites:
                  graph[course].append(prereq)

              # 0 = unvisited, 1 = visiting, 2 = visited
              state = [0] * numCourses

              def has_cycle(course):
                  if state[course] == 1:  # Currently visiting -> cycle
                      return True
                  if state[course] == 2:  # Already visited
                      return False

                  state[course] = 1  # Mark as visiting
                  for prereq in graph[course]:
                      if has_cycle(prereq):
                          return True
                  state[course] = 2  # Mark as visited
                  return False

              for course in range(numCourses):
                  if has_cycle(course):
                      return False
              return True
    function_signature:
      name: canFinish
      params:
        - name: numCourses
          type: int
        - name: prerequisites
          type: "List[List[int]]"
      return_type: bool

test_cases:
  - input: [2, [[1, 0]]]
    expected: true
  - input: [2, [[1, 0], [0, 1]]]
    expected: false
  - input: [1, []]
    expected: true
  - input: [3, [[1, 0], [2, 1]]]
    expected: true
  - input: [3, [[1, 0], [2, 1], [0, 2]]]
    expected: false
  - input: [4, [[1, 0], [2, 1], [3, 2]]]
    expected: true
  - input: [4, [[1, 0], [2, 0], [3, 1], [3, 2]]]
    expected: true
  - input: [5, [[1, 0], [2, 0], [3, 1], [4, 2], [4, 3]]]
    expected: true
  - input: [3, [[0, 1], [0, 2], [1, 2]]]
    expected: true
  - input: [4, [[0, 1], [1, 2], [2, 3], [3, 0]]]
    expected: false
  - input: [2, []]
    expected: true
  - input: [5, [[1, 4], [2, 4], [3, 1], [3, 2]]]
    expected: true
  - input: [6, [[1, 0], [2, 1], [3, 2], [4, 3], [5, 4], [0, 5]]]
    expected: false
  - input: [8, [[1, 0], [2, 6], [1, 7], [5, 1], [6, 4], [7, 0], [0, 5]]]
    expected: false
  - input: [3, [[1, 0], [1, 2], [0, 1]]]
    expected: false
  - input: [4, [[2, 0], [1, 0], [3, 1], [3, 2], [1, 3]]]
    expected: false
  - input: [5, [[0, 1], [0, 2], [1, 3], [1, 4], [3, 4]]]
    expected: true
  - input: [7, [[1, 0], [0, 3], [0, 2], [3, 2], [2, 5], [4, 5], [5, 6], [2, 4]]]
    expected: true
  - input: [20, [[0, 10], [3, 18], [5, 5], [6, 11], [11, 14], [13, 1], [15, 1], [17, 4]]]
    expected: false
  - input: [3, [[2, 0], [2, 1]]]
    expected: true
  - input: [5, [[1, 0], [2, 1], [3, 2], [4, 3], [0, 4]]]
    expected: false
  - input: [6, [[0, 1], [1, 2], [2, 3], [3, 4], [4, 5]]]
    expected: true
  - input: [4, [[3, 0], [3, 1], [3, 2]]]
    expected: true
  - input: [4, [[0, 1], [0, 2], [1, 3], [2, 3]]]
    expected: true
  - input: [2, [[0, 1], [1, 0]]]
    expected: false
